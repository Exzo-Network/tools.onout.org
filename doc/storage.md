# Блокчейн хранилище

Что это? Это смарт-контракт созданный для хранения данных. Для более удобной работы с данными и удешевления использования они хранятся в виде обычных строк, которые нужно изменять за пределами контракта. Все что он делает это сохраняет, меняет, возвращает и удаляет строк(у|и). А за то что в них находится отвечает фронтенд сторона.
Основной контракт для использования находится на **Binance Smart Chain**: [Storage](https://bscscan.com/address/0xa7472f384339d37efe505a1a71619212495a973a#code=)

## Сохранение и загрузка данных

Общая схема работы:

```
интерфейс приложения <-> внутренний код <-> хранилище
```

Если мы хотим видеть сразу увидеть изменения в интерфейсе, после сохранения данных, то нужно в ручную следить за изменением данных в контракте. Пример этой схемы разберем на логотипе: где-то в приложении есть логотип и нужно менять его в зависимости от того что выбрал пользователь.

> приблизительный код с примером на [React](https://reactjs.org/). Много частей уменьшенно и упрощенно.

1. В интерфейсе добавляем `input` для адреса логотипа
2. Добавляем кнопку, которая будет сохранять адрес

```html
<input value="{logoUrl}" onChange="{onLogoUrl}" />
<button onClick="{saveLogo}">Save</button>
```

3. добавляем обработчик сохранения:

```js
const saveLogo = async () => {
  await saveData({
    provider: library.provider,
    owner: account,
    data: {
      logo: logoUrl,
    },
  });
};
```

4. где-то создаем функцию `saveData` (можно делать все из компонентов, но лучше разделить функционал и делать это в других частях кода):

```js
import Web3 from "web3";
import { STORAGE_ADDRESS } from "somewhere";
import { Storage } from "somewhere";

const saveData = async ({ provider, owner, data }) => {
  const web3 = new Web3(provider);
  const storage = new web3.eth.Contract(Storage.abi, STORAGE_ADDRESS);
  const currentDomain = window.location.hostname;

  return storage.methods.setKeyData(currentDomain, {
    owner,
    info: JSON.stringify(data),
  });
};
```

5. Добавляем загрузку данных ...

## Ответы на популярные вопросы

что именно проходит прогер когда начинает писать админку:

1. понять в чем отличие базы данных (того же вордпресса) от хранения в сторадже. почему это лучше? почему обязательно использовать блокчейн? почему именно этот контракт?
2. понять как именно хранятся данные в контракте стораджа
3. понять какими методами контракта (в бч, не в js) надо будет сохранять и загружать данные
4. понять как это делать при помощи js, при помощи каких методов web3.js
5. понять как связать это c интерфейсом, какой js сторадж использовать (я хз что это, но мы помню долго спорили) - реакт-контекст или мобикс или что
6. Как происходит привязка стораджа к домену, почему другие люди не могут подделать данные домена?
7. надо ли интегрировать дизайн админки внутрь дапки чтоб был в том же стиле, почему бы не сделать сделать одну универсальную админку типа как [bootstrap](https://themes.getbootstrap.com/product/hyper-responsive-admin-dashboard-template/)

ну и так далее. ВАЖНО плавно провести прогера по всем этим кочкам

при этом дав ему на каждом этапе пример из кокосдб. при этом он дать понять, что прогер волен сам на фронтенде использовать любые либы, контракт же менять нельзя (т.к. он един для универсальности протокола)
